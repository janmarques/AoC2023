//using AoC2023;
//using MathNet.Numerics.LinearAlgebra;
//using System.Numerics;
//using static AoC2023.Utils;

//var fullInput =
//@"...................................................................................................................................
//.#........#.#.........#................##.#.............#....................#....#....#.#...#.......#..........#........#.........
//....#......#.....................##...#.#....#.#..#...#.......................#.....#..........##....#..#........#.##..#..#...#....
//.#.....#.............#.#...............#...........#.#.#................#...........#.#.....#.......##......#........#.#...........
//.....#...........#.......##.#.#..........#....#....#..#.#..................................#....##...#.#.....#..#.......#...#...#..
//...#....##............#...#..#.....#....##....#....##...........#...............#..##..#..............#..#......#.....#............
//..##....#.........#.......#..#...#...........................................#.....#.#........#...#.......................#.....#..
//..##.#........#..........#......#...#.....#..#.......#........................#..........##......#...#.#..............#......#.....
//........#....##.................................#.##.........#.......#........#...#..#.....................#.#.##....#.........#...
//.#...............#....#..........#....#.#...........................................................#.#.....#...#...#.........#....
//..#........#.##..............#...##.....#..#...#....................................#..##......#..#.......#........................
//...........................................#.................#.#..................#..#..#..#....#..#................#..........#...
//.....#...#...#.#......#.....#.#.....#.#..#........................#..#.##...................#.................................#.#..
//......#...........#.........##....#.#.#....#..............#........#....................#.............#..##...#.............#......
//..#...........##....#......#..#........................#.#........#..#...#...........#............................#.#............#.
//.#....#..#......#..........................#.......................#....#...........#......#.......#...............................
//....#.#...##....#.........#....#...#.#..#............................#.......#...............................................#..#..
//.......#..........##......#..#...#.....#............#...#...................#...............#..#..................#.....#..#...#...
//..................#.........#....#.#....#..#....................#..................................................................
//.#.##.................#....#..#.......##.#.................#.#............#...#..........#.#...#.........##.#...............#......
//..#........#.....#.#.........#.#.....#..#........#...#.....#....#....#.....................##....#...............................#.
//..#...#....#.#.............#..#..#...............##.......##.........#.....................................#....###.....##....#....
//....#..####.....#....................#................#.......#.............#..#..#..........##......##.......#...........#........
//..........##..#........#.......#..............#.#......#..#....#.............#...#................#......##...#..#......#..........
//......#....#...#........#.............................##..#.....#..............#.#......................................##.#...#...
//.#..........................................#.......#...#.##..#............#.......................#.#...##........................
//............#.#...........#.....#....................##...#...#....#.................#.#.........#......#........#......#...#......
//.#.....##.#..#..........#....##............#...........#.#.....#.......#............#.#............#...............................
//.........#........#...#.###.....#.........#.#...##.##....##..........#................................#..........#...##...#........
//...........#.........##...#.#..................................................#.........#..................#.........#.......#....
//....##...#..#.#..#.......................#....#......#............#....#.........###......#..............#.......#...#..........#..
//...........#.......#......#...............................#.....#.......#..#...............#.........##........#.#.........#.......
//......#....#.................#..............#..#..........#...#........................##..............#.........................#.
//.###.##...#.##........#........................#.#.###................#...#.#....#...........#...............##.........#..........
//...........................................#.........#..##.................#...#.#.#..##..#............#.#.#.....##.....#..........
//.#............................................#..#............#....#...#...#......#.#..........................#....#.#..........#.
//...........#...........#................#........#..........#........#...........#..............#.........#....##....#....#...##.#.
//................#............................#...#......#.....................#..............#.........................##..#...#...
//...#....#.............................................#..................#.....#.#..#.....#................#.......#....#..........
//.#....##..#.#.......#.............#..............#...#..#....................#..#........#.#.......................................
//.#...#.......................................................#..........#.........#.......##...#.#.#............###............#.#.
//.....#.....#......#..............#.#...............#....#.....................#......#....#.#........#.........#....#.........#....
//............#.#.###.......................................................#...................#....#...#.......##............#.....
//.#......#..............................#..........#....#....#.#.#........#............#.....#........................#......#......
//................#......................##.......#.......#..#..............##...................#...#...#...........................
//.#...#..................#.......................#...#...#..........#.......#.......#...................##...................#......
//........#...............#...#....................#..#.......................#.............#.#.#..........#..........###........#.#.
//.#..##...#..#............#.....#.....................#......#..............#......#..#..............#.....................#........
//....#...###.....................###..........#....#....#..............#................#.#.......#.#....##............#......#.#...
//......#.....................#.......#.#.#...#....#...#.#.....#..#........##.#..#..#......##........................................
//.......#.#............#...........#........#..............#....##..##..................##..........#...........#.......#..#..#...#.
//..#..#......................#..................................#....#......#...#............##......#......................##...#..
//.#...............................#.#.........#.....................###.#..................##.#...#.......#....................#..#.
//......##................#.........#......#................#........#.....#....#.#.##..#..#...##...#.#...........#................#.
//..#..#.........#...............##..................#........................................#........#......##.....................
//...................#....#......#...................#.#.....#..............#....##................#......#...#......#.........#.....
//....#...........#.......#......#..........#.....................#..#.........##.....##...........###......##.......................
//.................#..#....#..##.........................................#......#..........#............#..#....#.................#..
//.............#..#........#..#..#.#.......#..........#...........#..#.........#.#...................###.....#.......................
//..#............#..#..#..#..................#.##.#...#.#...#............###......#........................#.........#..#.........#..
//...........#..##.#..#.............#...#.............#.........#.....#.......#..................#...##..##......#...#..#............
//..............#...#...#.....##....#.#........#................#.....#.....#......#.......##....#.....#......#..#....#..............
//.............#....#..##..#.................#....#.#......#.#......#...##.....#....###.......#.......#..............................
//............................#..........#.......#................#....#.........#.......#.#..................#......................
//..........#...#.......#......................................##..........#..#......#............#..............#.....#..#..........
//.................................................................S.................................................................
//................#.........#.....#........#......................#....#.#.............#....#...#.............#...........#..........
//.........................................#......#............#...........#.......#......#..##.........##.............#.............
//........#................#.......#..........#.....#..........#........#.................##......#.............#.....#.....#........
//........#........#......#.......#....#...##.....................#.........#.....#.........#.................#..#...................
//.............#............................#.......#......#...##.........##...#......#.....#.#...#....................#.............
//..................................................#......#.......................#..##..#...##........#.#........#.................
//.#...........#..#.......#.....#...............#...#.....#..........#...#.#.#.......#.#..........................#.#................
//.####...............#...........#......#..#...................#....#....#...........#...#...................#.................#.#..
//...............#......#.##...............##..#..#........#..........#.#.............##......#............#...#.....#............#..
//.......................#.....###..#....#..#........................................#.#.............#...#........#..................
//.....................##....#...............#.........#....#.####...#......#.................#.#...........#......##..........#.#...
//..................#.................###...#............................#.#...##..#.#.#..#...#.................................#..#.
//....................#..........#..............#............................#.......#.........................#................#....
//.#..#...............#.........#..#..........#...#..........##.......##.##.....#....#...#.#......#...##.#...........................
//....#...............#....#.............................#.....#.........#..............#......#..............#............#.......#.
//........................#...........#..........#...#............#...#.#....#.............##..............##.#...................#..
//...#..................#.#...#...#.........#...........#.....#...#.##........#.#....#..........#.......##...........................
//.........#.#..........##.#....................#....#................#..#.#.....#...........#.........####.............#.......##...
//.#......#...................#........#.......#........#...#..#..........#..##..#..........#........................................
//.....#....#..#................##.....#......#.........................#.###...................#..#................#..#......#......
//..............#..........................................#.........#.....##.###............#...##.....................##...........
//..#......#..#.#.#.........#...#....................#.........#.........#......#...#.....................................#..........
//.......#...#.................#..........................#...##..#...#.#.........##............#..................#...............#.
//....#.........#.............#.......#.#..........#................#..##.#.#.#...................#.....#............#.....##....#...
//.###...............................#.........#..............#.#......#......#.....##.#.#.......#................#.#..............#.
//...#........#......#........................#.......#.##...#.........#........#...#.......#..##....#...........#....#..##..........
//......#.......#........#.......#..#...#....#.......#....#.#..........##........#..#...............#.......................##..#....
//...................#....#..........#........#.............#...#...##...#..........#.......#...#............#..........##...........
//.#........##......#.#................#.....#..........#....###................#.....#.......###...............#...#..........#..#..
//...#.........#...#....#............#..................##....#......#.....#.......#..........#...#...........#.....#..#.......#.....
//........#.................#........#.........#...............#...........#.##...##.......#..................#.......#....##........
//.###......#.....#......#.....................##..#...#........#........#....#................................#....#.....#.#........
//...........##..............................#..#...........#....#...#......#.#..#......#...............#............................
//.....#.#..#.........#............................#.....#.#.##......#.#.........#.....#.#...........................#...##......#.#.
//..............#.#.#.....#.#.............#..#.#.....#....#..#.#....#.................#....................#..........#........#.....
//..........#.....##.......#................#....................................#..#......#.........#..............#...#......##....
//.##.#......###..............#.#...............###......#.................#.......#......#.............................#....#.#.....
//..#..#...#............#....##.............#........................#.#..................................#......................#...
//......#.....#.............#...#............#....#.......#.....#.................................#..##...#.#..............#.........
//...........#..........#..#.#..................##...........#.......#........#....#.............#....................#.....#........
//....#...........#........##........................................#.#...............#.............#.#...##...#........#...........
//...#..#..............................................................#...#.#...#..#...........#..#..#....#..#..#.......#..#........
//...................#.#.....##...........................#................#.#...#...........#.............................#.........
//.....###.........#.....#...#...##...#..#........###.....#..#..............#.....#...................#...#...........#...#..........
//..............#......................................#..#....#.........##....##..#.......#.......................#.....##..........
//..#...................#...........#................................#.....#.#.#..........................#....#......#......#.......
//..#......#....#..##..#....#............#...........###........................#.........#........#........#............#.........#.
//...................#.##...........#....#..##............#...................#.........#........##........#...........#.#...........
//...#.#......#....#........#.......#....................................#.##..#.........#....#.#.....#.........................#..#.
//....#.#...#...........................................#...#..#....#....#..............#.........................#.....#......#..#..
//......#..................#..........#..#....#.......................#...............#...........#..............#....#.#............
//.#..............#........##......#...#....#...#.#................................................#.....##....#...##...#.#........#.
//.........#.............#..#..#...........................#.............#...........................#....##............#............
//..........#...#.....#..#...#...........#.#.......#........#.....................#.....#.....#...#.#..#......#....#....#...#..#.....
//.#........#............##.................##...............#.....................#.##.................#........#......#............
//....#........##....#..#.#.........#................................#................#.#.....#.............#..#....##.#....##.......
//........#.#.....#.......#.#..##..............##...................#...................#..#....................#..#.......#...#.##..
//.....#.#.........#.#....###..#..#.......#.....#................#....#........#.....................#.###.....#...........#......#..
//......#...#................#..#...##............#......#...................#............................#.........#....##...##.....
//..........#...##.....#....#...........#.....#......#..#.......................##...#.##.....#...#..##...#...#..#..#..........#...#.
//......#............#...........#.#..#...............#.............................#..#.......#...#.................#.......#....#..
//..............#........#............#....#.....##...#.###...................#............#..#.#..................#.............#...
//.............#....#.......#..#......#....#...#..#.......##.............#.##...#.........#..........................#.#...........#.
//.#..............#...#......#.......#..#................#.#.............#....#...............#.......#..............................
//...................................................................................................................................";

//var smallInput =
//@"...........
//.....###.#.
//.###.##..#.
//..#.#...#..
//....#.#....
//.##..S####.
//.##..#...#.
//.......##..
//.##.#.####.
//.##..##.##.
//...........";

//var smallest = "";

//var input = smallInput;
//input = fullInput;
////input = smallest;
//var timer = System.Diagnostics.Stopwatch.StartNew();

//var result = BigInteger.Zero;

//var grid = Utils.ParseCoordGrid(input).ToList();
//var width = grid.Max(x => x.x) + 1;
//var height = grid.Max(x => x.y) + 1;

//var unvisitable = grid.Where(x => x.c == '#').Select(x => (x.x, x.y)).ToHashSet();
//(int x, int y) Mod((int x, int y) n) => (Utils.SafeMod(n.x, width), Utils.SafeMod(n.y, height));
//bool Visitable((int x, int y) n) => !unvisitable.Contains(Mod(n));
//var start = grid.Single(x => x.c == 'S');

//var s = grid.Single(x => x.c == 'S');

//var toVisit = new HashSet<(int x, int y)>() { (s.x, s.y) };
//var toFind = new[] { width / 2, (int)(1.5 * width), (int)(2.5 * width), }.ToDictionary(x => x, x => int.MinValue);

//for (var i = 1; ; i++)
//{
//    IEnumerable<(int x, int y)> Get((int x, int y) item)
//    {
//        foreach (var d in new[] { (1, 0), (-1, 0), (0, -1), (0, 1), })
//        {
//            var newCoord = (item.x + d.Item1, item.y + d.Item2);
//            if (!Visitable(newCoord)) { continue; }
//            yield return newCoord;
//        }
//    }
//    toVisit = toVisit.SelectMany(Get).ToHashSet();
//    //Console.WriteLine($"{i} {toVisit.Count}");

//    if (toFind.ContainsKey(i))
//    {
//        toFind[i] = toVisit.Count;
//        if (toFind.All(x => x.Value != int.MinValue))
//        {
//            break;
//        }
//    }
//}

//var m = Matrix<double>.Build.DenseOfArray(new double[,]
//{
//     { 0,0,1 },
//     { 1,1,1 },
//     { 4,2,1 },
//});
//var mResult = m.Solve(MathNet.Numerics.LinearAlgebra.Vector<double>.Build.Dense(new double[] { toFind.Values.ElementAt(0), toFind.Values.ElementAt(1), toFind.Values.ElementAt(2) }));
//var _A = (int)mResult[0];
//var _B = (int)mResult[1];
//var _C = (int)mResult[2];


//var targetSteps = 26501365;
//var _X = new BigInteger((targetSteps - height / 2) / height);


//result = _A * _X * _X + _B * _X + _C;


//timer.Stop();
//Console.WriteLine(result);
//Console.WriteLine(timer.ElapsedMilliseconds + "ms");
//Console.ReadLine();