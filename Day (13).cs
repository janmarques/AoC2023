//var fullInput =
//@"##..##..##.
//######..###
//.####.##.##
//..........#
//.####.##.##
//.####....##
//..##..##..#

//##.##.#.#..##
//##.##.#.#...#
//.#.###......#
//.###.##..#..#
//##.#.##....##
//.#..###.###.#
//.#...#...#.##
//#.#.##.#...##
//#.###.#.##.#.
//#.#.#...####.
//#.#.#...####.
//#.###.#.##.#.
//#.#.##.#...##

//.........#.##
//...........##
//..###....##..
//##.##.#..#..#
//####....####.
//##.####.#####
//....##.#.....
//##.#..##..#.#
//###...##.....
//##..##..###..
//......######.
//###.##.#####.
//...#.##.#####
//##..#..#.##.#
//#####..#..##.

//.#....########...
//.##.....####.....
//.##.....####.....
//##....########...
//..#..##..##..##..
//####.###.##.###.#
//#.######....#####
//..#.#...####...#.
//....##.#.##.#.##.
//#.#...##.##.##...
//.#.##..##..##..##
//#.##.#.#.##.#.#.#
//.#.#....#..#....#
//.#...###.##.###..
//##.###........###

//..###..##..
//.#.#.....##
//#.##..##.#.
//#.#..###..#
//.#..##.##.#
//.#....##..#
//#.####.##.#
//#.####.##.#
//.#....###.#
//.#..##.##.#
//#.#..###..#
//#.##..##.#.
//.#.#.....##
//..###..##..
//..###..##..

//####..#
//#...#.#
//.##.#.#
//.##.#..
//####...
//.##.###
//.##.##.
//....###
//.##..#.
//......#
//####..#
//######.
//####.##
//####...
//####...

//#####.#..
//#.#......
//#.#......
//#####.#.#
//#####.#.#
//#.#......
//#.#......
//#####.#..
//.#####...
//#..#...##
//#.#..##..
//####.####
//#...##...

//.#.##.....#.#..
//....####.##.###
//#.#..#...###...
//.###..#.###...#
//..###.##..###..
//...#..#.....###
//...#..#.....###
//..###.##..###..
//.###..#.###...#
//#.#..#...###...
//....####.##.###
//.#.##...#.#.#..
//.#.##...#.#.#..
//....####.##.###
//#.#..#...###...
//.###..#.###...#
//..###.##..###..

//#......
//..#.##.
//##.#...
//.##..#.
//.##..#.
//##.#...
//..#.##.
//#......
//#......
//..#.###
//##.#...

//.##...###
//......##.
//.##..##.#
//#..#.#..#
//....#.###
//#..#.#..#
//.....#..#
//######.#.
//######.#.
//.##..##..
//.##.....#
//#..#.....
//#..#.#...

//.#..#.###.#..##
//.#..#.###.#..##
//#.##..#..####..
//#.#####..#..#..
//#..#..#.#...###
//..#.##.##.##.##
//..#..##.#.##.##
//####.##...#..#.
//..#...#..#.#...
//###.#.#..#...##
//.#..#######..##
//###.#.#.###....
//.#.....#.....##

//##.#.#..#.##.#..#
//.####..##....##..
//#.##.#.##.##.##.#
//#..#..#..#..#..#.
//###.#############
//#.##.............
//...####..####..##
//..#..##..####..##
//#.#.#.####..####.

//#..#...
//..#.##.
//#####.#
//#..####
//####..#
//......#
//....###
//#..#.#.
//####.##
//####.##
//#..#.#.

//####...
//##.#...
//####...
//.#.#...
//##.####
//##.##..
//#####..
//##.#.##
//.##....
//.##.###
//##..#..
//#..####
//#...#..

//.#.##.#..
//.#....#..
//#......##
//##.##.###
//..####...
//#.#..#.##
//.##..##..
//........#
//...##....

//###.#.##...#..#..
//###.#.##...#..#..
//#....#.#.###..###
//.####.#.##......#
//#####.#.##.####.#
//#.##....#...##...
//...#.###...#..#..
//###...##..#####..
//##..#.###........

//#....######....#.
//#....#.##.#....#.
//..##........##..#
//.##.#..##..#.##..
//#....##..##....##
//..##..####..##..#
//.#..#......#..#..

//..#..#.
//#..#.#.
//#..#.#.
//.....#.
//##.....
//.####.#
//.####.#

//####...##..##..
//####.####.####.
//..#.#.##..####.
//..#.#.##..####.
//####.####.####.
//####...##..##..
//.###.#.##.#.##.
//####.#.##.####.
//#...#.##.......
//#..###.##.####.
//.#...#####....#
//####.###.#.##.#
//.#.###.###....#
//..#.##..##.##.#
//#.###..#.#.##.#

//##.###..##.
//.####......
//.####......
//##.###..##.
//######..##.
//.#.##......
//.##..#.#..#
//#.#...#..#.
//#.#.##.....
//###.###....
//...#..#.##.

//.......#.####
//.......#.####
//#..##........
//.#...###.##.#
//##.#.##.#####
//#.#####...#.#
//.#.###.####.#
//..###....#..#
//#.#.####..##.
//#.#.####..##.
//..###....#..#
//.#.###.####.#
//#.#####..##.#
//##.#.##.#####
//.#...###.##.#
//#..##........
//.......#.####

//#....##.###
//#.#.#.#.#..
//#.#.#.#.#..
//#....##.###
//#.#...#.#.#
//.#......##.
//.#..#.##...
//....#..#..#
//.###.##.##.
//.###.##.##.
//....#..#..#
//.#.##.##...
//.#......##.
//#.#...#.#.#
//#....##.###

//.#....#.##.
//..#...#....
//####...####
//..#.#######
//.##...#....
//#.###.#....
//#.###.#....
//.##...#....
//..#.#######
//####...####
//..#........
//.#....#.##.
//#.#.#.#....
//.#.##......
//.##..#.#..#
//#..##......
//#.######..#

//.###.#.####.#.#
//#..##...##...##
//#..##.##..##.##
//.###.#......#.#
//##..##.####.##.
//....##.####.##.
//.#...########..
//...#...####...#
//..##..........#
//..##....##....#
//..###.#.##...##
//.#.###.#..#.###
//.###...#..#...#
//##.#####..#####
//##..#........#.
//#######.##.####
//#######.##.####

//###...##......#
//###....#......#
//#..#.#.#......#
//..##.##........
//#.#...#.##..##.
//###...#########
//.#...###.####.#
//..#..#...#..#..
//..#.##.##....##

//.##..#..###.#.#
//.##..##.....##.
//....###.####..#
//.......###..#..
//######..#.##..#
//.##..#.#####.#.
//.##..#.###.#.#.

//..##.##....##
//#.##.#....##.
//#....##.#.##.
//######.#.####
//######..#....
//#....#..#..##
//.#..#.####...
//.####.##.#...
//.####.##.#...

//#...##...#.#.
//#..####..#.##
//#........#..#
//.#.####.#..##
//..##..##..###
//#.####.#.#..#
//##.#..#.##.#.
//...####...##.
//#.######.#.##
//#.##..##.#...
//.##.##.##..#.
//.##.##.##....
//#.#.##.#.#.##
//#........####
//############.
//##.####.##.##
//##.####.##.##

//.#....##...
//...#......#
//##.##....#.
//...#......#
//..#.#....#.
//#..##....##
//###.######.
//.###......#
//#.#..#..#..
//..#.#....#.
//..##.#..#.#
//..##......#
//####.####.#
//#..###..###
//#.###....##
//..###.##.##
//..###.##.##

//#.....#.#....#.#.
//##....#.#....#.#.
//#.##.#.###..###.#
//.#.##.#..#..#..#.
//###...##.####.##.
//#.###.####..####.
//#.#.....######...

//##.#..#.###
//...####...#
//###....####
//###....####
//...####...#
//##.#..#.###
//#.##.###.#.
//..#.##.#..#
//##......##.
//..######...
//#.#.##.#.##
//#.##..##.##
//..######..#

//#####.##...##...#
//#..##.###.##.##.#
//.##..#.#.......##
//....####.#.##.##.
//#..#..#..#...##..
//#..##.##.#.#.##.#
//#..##.##...#.##.#

//..#.#.####.#.#.
//##.####..####.#
//##.#........#.#
//..#....##......
//#####......####
//..#.#.####.#.#.
//..#.#.#..#.#.#.
//...##..##..##..
//..#.#......#.#.

//..#.###.##.##
//##.#.##...###
//..#####..#.##
//####..####.##
//##...#.#.....
//.##...#.##...
//####....###..
//##...###..###
//..#..##..##..
//##.##.#.#..##
//####.#..#.###
//...###.#.####
//...#..#.##.##
//##.....#.....
//...########..
//#####...##...
//##.#.#....#..

//...##.##.
//###.#####
//..######.
//##.#.....
//...#.####
//##.###..#
//##.#.#..#
//..##.####
//..#.#.##.

//.##....##..#..#
//####.#.#....##.
//#.#....#..##.#.
//#..#...###..#.#
//#.#.###..#####.
//.#...#....#...#
//.#...#....#...#
//#.#.###..#.###.
//#..#...###..#.#
//#.#....#..##.#.
//####.#.#....##.
//.##....##..#..#
//.##....##..#..#

//..##.......
//.####..###.
//......###..
//......###.#
//..#....#..#
//##..##..#..
//.####..##..
//..##..#..#.
//#....##.#.#
//#....##.#.#
//..##..#..#.
//.####..##..
//##..##..#..

//###.##.######
//....##.......
//##..##..####.
//..#.##.......
//..#....#....#
//#........##..
//###....######
//..#....#....#
//.#.####.#..#.
//#.##..##.##.#
//.#.####.#..#.
//.########..##
//#.##..##.##.#

//###....####..#.##
//##.#..#.#####.###
//....##....###..##
//...#..#....#.##..
//.########..#.....
//..######...######
//.#..##..#..#.#..#

//#####.##.##..
//....##..#.###
//.##...###.#.#
//.##..#..##...
//.##.#..#..#.#
//#..#...###.##
//....#..##..##
//#####....##.#
//......####...
//.##...##..###
//.##.####.###.
//....##...##.#
//....##..#...#
//.##.#..####..
//####.####....
//.##..#...#.#.
//.##..#...#.##

//##.#....##....#
//.#.###.#..#.###
//.##.#.##..##.#.
//.###.##.##..#.#
//..##..#.##.#..#
//...#.#......#.#
//.#.###......###
//.##..#.#..#.#..
//...#.##....##.#
//######..##..###
//..#.#..####..#.
//##...##.##.##..
//#.#####....####
//#.#####....####
//##...##.##.##..
//..#.#..####..#.
//######..##..###

//##.##....
//###......
//....#.#..
//#..#.##..
//#..#.##..
//....#.#..
//#.#......
//##.##....
//#####..##
//##..#.#..
//####.##..

//#.#....
//#.....#
//.###..#
//.###..#
//#.....#
//#.#....
//#.##..#
//#...###
//##.#...
//..##.##
//##..#..
//..#...#
//..#....
//##..#..
//..##.##

//#..#.##.....#
//#..#.#....#..
//.##.###....#.
//.##.###....#.
//#..#.#....#..
//#..#.#......#
//#..##....##..
//.##.....####.
//#..##..#...#.
//.##.#..#...#.
//#..#..#......
//.##..#.##.#..
//.....#####.#.

//..#.#..##
//###.####.
//...#..##.
//.....#.#.
//...##...#
//.....#.#.
//####.....
//#####....
//.....#.#.

//#..#####..#
//#......###.
//#......###.
//#..#####..#
//######.....
//#.##.....##
//..#####.##.
//###......##
//###.....###
//..#####.##.
//#.##.....##

//.#.....#.#.
//...#.###.##
//...#.######
//.#####....#
//##.#..#..##
//##.#..#..##
//.#####....#
//...#.######
//...#.###.##

//..#......
//##..#.#.#
//#.#.#.#.#
//#.####..#
//.##...##.
//.#....##.
//#.####..#
//#.#.#.#.#
//##..#.#.#
//..#......
//..#......

//.#####.#..####.
//#..#..#...####.
//##.###..#..##..
//#..###..#..##..
//#..#..#...####.
//.#####.#..####.
//#.........####.
//#.####.###.##.#
//..#.###....##..
//#.#.#..####..##
//#..##.##..####.
//.....#.####..##
//###.......####.
//..#...#........
//###.#.##.######
//###..###...##..
//...#...##..##..

//..#.##.....#.#.
//.####..##..####
//.#....####....#
//#...###..###...
//..#.##....##.#.
//..#.##....##.#.
//#...###..###...

//#........##.#.###
//.#.##..##.....#..
//.#.#.#.#.####..#.
//.#.#.#.#.####..#.
//.#.##..##.....#..
//#........##.#.##.
//#.#.###.#....#...
//#.#.###.#....#...
//#........##.#.##.
//.#.##..##.....#..
//.#.#.#.#.####..#.

//..#...#####
//#.##...##..
//##...##..##
//##...##..##
//#.##...##..
//..#...#####
//#.####.#..#
//...#..###..
//#..##.##.##
//#.##.#..###
//.###.##.#..
//.#.#...#.##
//#..###..#..

//....#...####...
//..##..##.##.##.
//##..##..####..#
//.#..###.#..#.##
//..###.##....##.
//...###..#..#..#
//...#.#.######.#
//..##..##.##.##.
//##..#...####...

//....##.....##.#.#
//#.#....#.######..
//############..###
//#.##..##.#.####..
//#.##..##.#.####..
//############..###
//#.#....#.######..
//....##.....##.#.#
//#.#.##.#.#.#..###
//#.######.##.####.
//#######.##.#.#.#.
//#.######.#..##.#.
//..#.##.#......#.#
//..#.##.#..##...#.
//.##....##.##..#..

//##..#...##...####
//##..#...##...####
//###......#.......
//.##.##..##..#.##.
//.#.#.#.##....#..#
//##..#.#.#..##.##.
//#..####...##..##.
//##.#....###.##.##
//.#...###.####....

//..#.#..######..#.
//..#.#..######..#.
//..#..##.......#..
//...#.#.######.#.#
//##...#.#....#.#..
//#.######....#####
//#..####..##..####
//......#......#...
//#...###.####.###.
//....#.#.#..#.#.#.
//#..#.###.##.###.#

//..########..#
//...#.#.##....
//##.###.#..##.
//###.#.#.#...#
//##.##....##.#
//...###.####.#
//###...#.###..
//###...#.###..
//...###.####.#
//##.##....##.#
//###.#.#.#...#
//##.###.#..###
//...#.#.##....

//##....#..#.
//##.#.#####.
//##.###.##.#
//#...###.##.
//#####..#..#
//##.##.#####
//..#..#####.
//...#.##.#.#
//...#.##.#.#
//..#..#####.
//##.##.#####

//.#.....#.###.###.
//##..##.#.###.#.#.
//##.###.#.###.#.#.
//.#.....#.###.###.
//..#....#.......##
//...###.#.#..#...#
//##.####.#.##..##.
//...#.##.##...##.#
//..##..#.##......#
//..##..#.##......#
//...#.##.##...##.#
//##.####.#.##..##.
//...###.#.#..#...#

//.###....##...
//##....##..##.
//###..##.##.##
//...#..#....#.
//#......####..
//.#.##...##...
//.....#.####.#
//#.####..##..#
//#.####..##..#
//.....#.####.#
//.#.##...##...
//#......####..
//......#....#.
//###..##.##.##
//##....##..##.

//...#.##
//#.###..
//#...###
//#...###
//#.###..
//...#.##
//.#.####
//#.###.#
//.#..###

//#.#..#.####
//.#....#.###
//########.##
//.##..##....
//#......#..#
//.#....#..#.
//#.#..#.##.#
//.######....
//.##..##..##
//##....####.
//##.##.###..
//#..##..####
//#......#..#
//##.##.###..
//.##..##...#
//.##..##...#
//##.##.##...

//.#.#.####....#.#.
//..#.##..##.#.##.#
//##..###....###.#.
//..#..#..##...####
//.##..#..####..###
//.####.##...##..##
//.####.##...##..##
//.##..##.####..###
//..#..#..##...####
//##..###....###.#.
//..#.##..##.#.##.#
//.#.#.####....#.#.
//.#.####.#...#.###
//...#.##.#.####...
//...#.##.#.####...
//.#.####.#...#.###
//.#.#.####....#.#.

//#####.#..#.##
//.##..#.###..#
//......##.####
//#..#.#...####
//#..#.#...####
//......##.####
//.##..#.###.##
//#####.#..#.##
//#..#.#.##...#
//.##....##...#
//#..###..#...#
//#..#..####...
//########...#.
//#..#.#..#####
//.##..#...#..#

//#.#..##..####
//.#.#.########
//####.#.......
//.......##.##.
//.#..#.#......
//######...#..#
//.##.####.....
//.##.####.....
//######..##..#
//.#..#.#......
//.......##.##.

//...#.###..###
//#.#####.##.##
//#.#####.##.##
//..##.###..###
//##.####....##
//...##########
//#.....##..##.
//.#....#....#.
//..#.#..####..
//.#....#....#.
//.###...####..

//#######.#....
//#######.#....
//.####..#..##.
//#....##..#.##
//##..#########
//..##..#####..
//...#..#.####.

//#..####..
//#..#.##..
//.....##.#
//#######.#
//####.###.
//######...
//#..#.####
//.##..####
//.##.####.
//.##....##
//....#....
//######.##
//.##.###.#
//#..#...##
//....###.#
//#######.#
//####..#..

//..##.#####....##.
//..##.#####.#..##.
//..##...#..######.
//#....#.#..#.#..#.
//###.#...#.##.##.#
//.##..####...####.
//#....###..#..##.#
//....#....#.##.#..
//..#...#####.###..
//#.#......#.#.#..#
//..####.#..##..##.
//..#####.##...#..#
//.#####..#....#...
//...#...#...#.##..
//...#...#...#.##..

//##..####...#.##.#
//##..##.#...#.##.#
//.####..###.#.#..#
//##..#####.#...#.#
//#....######..##..
//#....#..###......
//..##..##.##.#.#..
//#.##.##..#...#.##
//.......##.....##.
//#######.####.#..#
//#.##.###.####.###
//.#..#...#..#.##..
//##..##.#.####.#..
//#.##.#..#..###...
//......#.#.#.#.##.
//........#.####..#
//..##...#.##..#...

//#.##...#.
//#.#..#..#
//#....##.#
//.#.#...##
//.#.#...##
//#....##.#
//#.#..#..#
//#.##...#.
//#...##.##
//.####...#
//.####...#
//#...##.##
//#.##...#.
//#.#..#.##
//#....##.#

//#####.#...#..
//#####.#...#..
//.##..###.#...
//.##.#.....#..
//#.#.#.##.#..#
//.###.########
//...#.###....#
//.#####..#.##.
//#.#...###..#.
//..#.#........
//..#.#......#.
//#.#...###..#.
//.#####..#.##.

//#.##.#.#.##
//#....##....
//.####.###..
//.####.###..
//#....##....
//#.##.###.##
//######.###.
//##..##....#
//#.##.##.###
//########..#
//#....##..#.

//..###..##..
//.#.#.##..##
//.#.####..##
//#...#######
//.####......
//#......##..
//##.....##..
//....#......
//....#......
//#...###..##
//.##.##.##.#
//##..#......
//#..#.######
//#.###..##..
//.#..#......

//##.#..#..#.
//#......#.#.
//#.####....#
//.#..#..####
//####.....##
//####.....##
//.#..#..####
//#.####....#
//#......#.#.
//##.#..#..#.
//..##..#.#..
//...#.##....
//.##..##.###
//###..##.###
//...#.##....

//....#..#.##
//......#..##
//#..######.#
//#..#..#.#..
//######.####
//.##.###.#..
//.##.#.#....
//#..##...###
//....#..##..

//#.###.#.#..#.
//#....###.##..
//#...#.##.##.#
//.....#.#....#
//##...########
//.##...##.##.#
//..####..#..#.
//.###...######
//.#.#.##.####.
//..##.........
//..##.........
//.#.#.##.####.
//.###...######
//..####..#..#.
//.##...##.##.#
//##...########
//.....#.#....#

//#...##.#....#
//#..###.#....#
//##.....##..##
//#.#..####..##
//#...#..#....#
//###.#.#######
//####.##.####.
//####.#.......
//#....##.#..#.
//.##.#.###..##
//#.#..#..#..#.
//#.#..#..####.
//..#...##....#
//.##.#..##..##
//####.###.##.#
//.##..#.......
//...##..######

//##.#..###
//##.#.####
//.##.#.###
//.#.#.##..
//.#..#####
//...###...
//#....##..

//.#..####..#
//#...#..#...
//#...#..#...
//##..####..#
//.###....###
//....#..#...
//.#.##..##.#
//##.#.##.#.#
//#..........
//.##.#..#.##
//#..#.##.#..
//.....##....
//.#..####..#

//##.#..#.#
//...####..
//..##..##.
//..##..##.
//###.##.##
//.########
//....##...

//###.####....##.
//###...#...##.##
//...#.#.#...#.##
//##...#....##.#.
//###..###.......
//......##..####.
//##..######..###
//##..######..###
//......##..####.
//###..###.#.....
//##...#....##.#.

//###.####.
//#....##..
//.#..#..#.
//#....##..
//..##....#
//#....##..
//##..####.

//#..#.######.#
//.#.##......##
//#.#....##....
//..#####..###.
//..#...####...
//....#......#.
//.##...####...
//.#.##.####.##
//..#..##..##..
//.##...####...
//#.####....###
//##...######..
//#..##.#..#.##
//#..##.#..#.##
//##...######..

//.........##
//........#..
//##....#####
//#.####.####
//..#..#..#..
//##....###..
//.#.##.#.#..
//#......##..
//#.####.####
//...##.#....
//.######....

//.##.######.##.#
//..###....###..#
//#.#.##..##.#.##
//###........####
//###........####
//#.#.##..##.#.##
//..###....###..#
//.##.######.##.#
//.#.#.####.#.##.
//..##########..#
//.#.########.#.#
//.#..#.##.#..#..
//#..#......#..#.

//.#.#..#
//.###..#
//..#....
//#.##..#
//#.#####
//..#....
//#..####

//##..#..####..#..#
//..###........###.
//##..###....#.#..#
//#..##.#.##.#.##..
//##..###.##.###..#
//..#...##..##...#.
//###.#.#....#.#.##
//#.#.#.#....#.#.#.
//##...#......#...#
//#...#.#....#.#...
//#...#.#....#.#...
//##...#......#...#
//#.#.#.#....#.#.#.
//###.#.#....#.#.##
//..#...##..##...#.

//#..##.#.#
//.#...##..
//.##.#..#.
//.##.#..#.
//.#..###..
//#..##.#.#
//.######.#
//#.#..#...
//#.#..#...

//.#..#.#.#..#.....
//#....#.##.#......
//#....#.##.#......
//.#..#.#.#..#...#.
//.#..#...#..###...
//#....##.##.#..#.#
//#.##.#..#..#.##..
//#....#####..##.##
//#....###.########
//.####.##..##.....
//..##.......#.....
//######.#.#.#.#.#.
//......##.###...##
//.####.#.##.#.#.##
//#....#..##.#..###

//#..##............
//.##.####..##..###
//.##..#.#.####.#.#
//......#.#....#.#.
//......##########.
//#..##.###..#.###.
//......##.####.##.
//.##.##..........#
//.##..#####..#####
//....#...#.##.#...
//.##...#..#..#..#.

//....#.##.#.##.#
//.##.##.########
//#..##.####.##.#
//.##.###.#.#..#.
//#####..##.#..#.
//.##...#.###..##
//.#...#....####.
//.....##....##..
//####.####.####.
//#####...##....#
//......#.#..##..
//#####...##....#
//####..####....#

//.#....#..#..#
//.#.####.#.##.
//###..#####..#
//.##..##.#....
//..#..#..#####
//#......#.####
//#......#.....
//...##...##..#
//##....##.#..#
//##....##.....
//#.#..#.#..##.
//###..###.....
//.######.##..#

//......##..#
//....#.#.##.
//..#.#......
//.#......##.
//.###..##..#
//.###..##..#
//.#......##.
//..#.#......
//....#.#.##.
//......##..#
//##.#.#.#.##
//.#.###.....
//####..#####

//##...#######.#.##
//##..###...#.#....
//...#.####.#..#...
//##.#...#.#...####
//####..#.##..##.##
//....#####.#.####.
//##.##..#.#.#.#...

//..#.#...#.#.##..#
//.##..#...##.#.#..
//#...##.#..#..##..
//#..#.#.#..#.#####
//#...##.###.#.###.
//##..#.#.##...#..#
//##..#.#.##.##.###
//####.##.#.#...##.
//.....###....###..
//#.##.#.##..#...#.
//.#..#.#....###..#
//#.#.####.#.#.#.#.
//#.#.####.#.#...#.
//##.###.##.##.....
//##.###.##.##.....
//#.#.####.#.#...#.
//#.#.####.#.#.#.#.

//######.#.#..#.#
//##..###........
//#.##.#....##...
//.#..#.####..###
//..##..###....##
//......#........
//#....###.####.#
//......#.##..##.
//#.##.##...##..#
//#....##.##..##.
//#.##.#.........

//####.##.#
//.##....#.
//...#####.
//...#####.
//.##....#.
//####.#..#
//####.#..#

//.###..###.####.
//###.##.####..##
//#........######
//#.#....#.######
//#.##..#..######
//##.#..#.##....#
//.#..##..#......
//#.#.##.#.##..##
//###.##.####..##
//..#.##.#...##..
//..######.......

//#...##..#
//#...##..#
//..######.
//.#.###..#
//#...####.
//.#..###..
//#....#..#
//#.#.#....
//####..#.#
//####..#.#
//#.#.#....
//#....#..#
//.#..###..
//#...####.
//.#.###..#
//..#####..
//#...##..#";

//var smallInput =
//@"#....##.###
//#.#.#.#.#..
//#.#.#.#.#..
//#....##.###
//#.#...#.#.#
//.#......##.
//.#..#.##...
//....#..#..#
//.###.##.##.
//.###.##.##.
//....#..#..#
//.#.##.##...
//.#......##.
//#.#...#.#.#
//#....##.###";

//var smallest = "";

//var input = smallInput;
//input = fullInput;
////var input = smallest;

//var result = 0;

//var block = new List<char[]>();
//var blocks = new List<List<char[]>>() { block };

//foreach (var line in input.Split(Environment.NewLine))
//{
//    if (line == "")
//    {
//        block = new List<char[]>();
//        blocks.Add(block);
//    }
//    else
//    {
//        block.Add(line.ToCharArray());
//    }
//}
//var grids = blocks.Select(x => x.ToArray()).ToList();

//foreach (var item in grids)
//{
//    var oldLine = Evaluate(item);
//    if (true && false)
//    {
//        result += oldLine;
//        continue;
//    }

//    var other = Other(item, oldLine);
//    result += other;
//    if (other == -1)
//    {
//        PrintGrid(item);
//        PrintGrid(Rotate(item));
//    }
//}

//int Other(char[][] item, int except)
//{
//    for (int i = 0; i < item.Length; i++)
//    {
//        for (int j = 0; j < item[i].Length; j++)
//        {
//            var cpy = item.Select(x => x.ToArray()).ToArray();
//            cpy[i][j] = cpy[i][j] == '#' ? '.' : '#';
//            var line = Evaluate(cpy, except);
//            if (line != 0 && line != except)
//            {
//                return line;
//            }
//        }
//    }
//    return -1;
//}

//int Evaluate(char[][] arg, int? except = null)
//{
//    var eval = arg.Select(x => new string(x)).ToArray();

//    var line = MirrorLine(eval, 100, except);
//    if (except != line && line != 0) { return line; }

//    var rotated = Rotate(arg).Select(x => new string(x)).ToArray();
//    line = MirrorLine(rotated, 1, except);
//    //return arg[0].Length - line;
//    if (except != line) { return line; }
//    return 0;
//}

//int MirrorLine(string[] eval, int factor, int? except = null)
//{
//    for (int i = 0; i < eval.Length - 1; i++)
//    {
//        if (MirrorsAlong(eval, i))
//        {
//            var result = factor * (i + 1);
//            if (result != except)
//            {
//                return result;
//            }
//        }
//    }
//    return 0;
//}

//bool MirrorsAlong(string[] eval, int n)
//{
//    var i = 0;
//    while (!(i + n + 1 == eval.Length || n - i < 0))
//    {
//        if (eval[n - i] != eval[n + 1 + i])
//        {
//            return false;
//        }
//        i++;
//    }
//    return true;
//}

//char[][] Rotate(char[][] input)
//{
//    var height = input.Length;
//    var width = input[0].Length;

//    var target = Enumerable.Range(0, width).Select(x => new List<char>()).ToList();

//    for (var i = 0; i < height; i++)
//    {
//        for (var j = 0; j < width; j++)
//        {
//            target[j].Add(input[height - 1 - i][j]);
//        }
//    }
//    return target.Select(x => x.ToArray()).ToArray();
//}


//Console.WriteLine(result); // 36669 too high (wihout prev) 22028 too low
//Console.ReadLine();

//void PrintGrid<T>(T[][] grid)
//{
//    for (int i = 0; i < grid.Length; i++)
//    {
//        for (int j = 0; j < grid[i].Length; j++)
//        {
//            Console.Write(grid[i][j]);
//        }
//        Console.WriteLine();
//    }
//}