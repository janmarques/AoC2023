//using AoC2023;
//using System.Text;

//var fullInput =
//@"#.###########################################################################################################################################
//#...#.....#.........#...#.......#...#...###...#...#...###...#...............#.........#.......#.....#...#...#.........#.....#...###.........#
//###.#.###.#.#######.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.###.#.#.#############.#.#######.#.#####.#.###.#.#.#.#.#.#######.#.###.#.#.###.#######.#
//###...#...#.......#.#.#.#...#...#.#.#.#...#.#.#.#.#.#...#.#.#.#.......#.....#...#.....#...#...#...#.#.#.#.#.#.#.....#.#...#.#.#...#.......#.#
//#######.#########.#.#.#.###.#.###.#.#.###.#.#.#.#.#.###.#.#.#.#.#####.#.#######.#.#######.#.#####.#.#.#.#.#.#.#.###.#.###.#.#.###.#######.#.#
//#.......#.....#...#.#.#.#...#.....#.#.#...#.#.#.#.#.#...#.#.#...#...#.#.#...###.#...#...#.#.#.....#.#.#...#.#...###.#.#...#.#...#.....###.#.#
//#.#######.###.#.###.#.#.#.#####.###.#.#.###.#.#.#.#.#.###.#.#####.#.#.#.#.#.###.###.#.#.#.#.#.#####.#.#####.#######.#.#.###.###.#####.###.#.#
//#...#...#...#.#...#.#.#.#.....#...#...#...#.#.#.#.#.#.#...#.....#.#...#.#.#.....#...#.#.#.#.#...#...#.....#.###.....#.#.#...###.#.....#...#.#
//###.#.#.###.#.###.#.#.#.#####.###.#######.#.#.#.#.#.#.#.#####.#.#.#####.#.###.###.###.#.#.#.###.#.#######.#.###.#####.#.#.#####.#.#####.###.#
//###...#...#.#.#...#.#.#.#.....###.......#...#...#.#.#.#.#.....#...#...#...#...###...#.#.#.#...#.#.#...#...#.#...#.....#.#.#...#.#.....#...#.#
//#########.#.#.#.###.#.#.#.#############.#########.#.#.#.#.#########.#.#####.#######.#.#.#.###.#.#.#.#.#.###.#.###.#####.#.#.#.#.#####.###.#.#
//#.........#.#...###.#.#.#.#...#.........###...#...#.#...#.#.........#...###.......#...#.#...#...#...#.#.#...#...#.#...#.#.#.#.#.#.....#...#.#
//#.#########.#######.#.#.#.#.#.#.###########.#.#.###.#####.#.###########.#########.#####.###.#########.#.#.#####.#.#.#.#.#.#.#.#.#.#####.###.#
//#.#...#...#.......#.#.#.#.#.#.#.............#.#...#.....#...###.........#.........#.....#...#.......#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#...#
//#.#.#.#.#.#######.#.#.#.#.#.#.###############.###.#####.#######.#########.#########.#####.###.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.###.###
//#...#...#...#.....#...#...#.#...............#.###.....#.#.......#...#####.........#...#...###.#...#...#.#...#...#.#.#.#.#.#.#.#...#.#.#...###
//#########.#.#.#############.###############.#.#######.#.#.#######.#.#############.###.#.#####.#.#.#####.#########.#.#.#.#.#.#.###.#.#.#.#####
//#.........#...###.....#.....#.............#.#...#...#...#...#...#.#.....#.......#...#.#...###.#.#...###.........#...#...#...#.#...#.#.#.....#
//#.###############.###.#.#####.###########.#.###.#.#.#######.#.#.#.#####.#.#####.###.#.###.###.#.###.###########.#############.#.###.#.#####.#
//#.#.....#...#.....#...#.....#.#...........#.....#.#...#.....#.#...#.....#.#...#.....#.....#...#.###.........#...###.........#...###.#.#.....#
//#.#.###.#.#.#.#####.#######.#.#.#################.###.#.#####.#####.#####.#.#.#############.###.#######.###.#.#####.#######.#######.#.#.#####
//#.#.###...#...#.....#...###...#.............#...#.#...#.......#...#.....#...#.....#.......#...#.#.......#...#.....#...#.....###...#.#.#.....#
//#.#.###########.#####.#.###################.#.#.#.#.###########.#.#####.#########.#.#####.###.#.#.#######.#######.###.#.#######.#.#.#.#####.#
//#...#...........#...#.#.#...#...#.........#...#...#.#...........#.......#.......#.#.#.....###...#.......#.........#...#.....#...#.#.#.#.....#
//#####.###########.#.#.#.#.#.#.#.#.#######.#########.#.###################.#####.#.#.#.#################.###########.#######.#.###.#.#.#.#####
//#...#...........#.#...#.#.#.#.#.#.......#.#...#...#.#.#.................#.....#...#.#.....#...#...#...#...#...#...#...#.....#.#...#...#.....#
//#.#.###########.#.#####.#.#.#.#.#######.#.#.#.#.#.#.#.#.###############.#####.#####.#####.#.#.#.#.#.#.###.#.#.#.#.###.#.#####.#.###########.#
//#.#...........#...#.....#.#.#.#.#.......#...#.#.#...#.#.#...............#...#.....#.#.....#.#.#.#.#.#.###...#.#.#.#...#.#.....#.#...#.......#
//#.###########.#####.#####.#.#.#.#.###########.#.#####.#.#.###############.#.#####.#.#.#####.#.#.#.#.#.#######.#.#.#.###.#.#####.#.#.#.#######
//#...........#.......#.....#.#.#.#...........#...#...#...#...#.......#...#.#.......#.#.#...#.#.#.#.#.#.#...#...#.#.#...#.#.....#.#.#.#...#...#
//###########.#########.#####.#.#.###########.#####.#.#######.#.#####.#.#.#.#########.#.#.#.#.#.#.#.#.#.#.#.#.###.#.###.#.#####.#.#.#.###.#.#.#
//#...#.......#...#...#...#...#.#.#...#.......#...#.#.###...#...#...#...#.#.#.....#...#.#.#.#.#.#.#.#.#.#.#.#.###.#...#.#.#...#.#.#.#.#...#.#.#
//#.#.#.#######.#.#.#.###.#.###.#.#.#.#.#######.#.#.#.###.#.#####.#.#####.#.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#.###.###.#.#.#.#.#.#.#.#.#.#.#.#.#
//#.#.#.........#...#...#.#.#...#...#.#.....#...#.#.#.#...#.#.....#.......#...#...#.#...#.#.#.#...#.#.#.#.#.......###.#.#.#.#.#.#.#.#.#.#...#.#
//#.#.###########.#####.#.#.#.#######.#####.#.###.#.#.#.###.#.#################.###.#.###.#.#.#####.#.#.#.###.#######.#.#.#.#.#.#.#.#.#.#####.#
//#.#.............#.....#.#.#.....#...#.....#.#...#.#.#.#...#...#.....#.....#...#...#...#.#.#.#...#...#.#.###.......#.#.#.#.#...#...#...#...#.#
//#.###############.#####.#.#####.#.###.#####.#.###.#.#.#.#####.#.###.#.###.#.###.#####.#.#.#.#.#.#####.#.#########.#.#.#.#.#############.#.#.#
//#.#...#.........#.....#.#.#...#.#...........#.#...#...#.#####...#...#.#...#...#.....#.#.#.#...#.###...#.#.........#...#...#...###...#...#...#
//#.#.#.#.#######.#####.#.#.#.#.#.#####.#######.#.#######.#########.###.#.#####.#####.#.#.#.#####.###.###.#.#################.#.###.#.#.#######
//#...#...#.......###...#.#.#.#.#...#...#.......#.......#...#...###...#.#...#.........#...#.#.....#...#...#...........#.......#...#.#.#.....###
//#########.#########.###.#.#.#.###.#.###.#############.###.#.#.#####.#.###.#.#.###########.#.#####.###.#############.#.#########.#.#.#####.###
//#.........#.....#...#...#.#.#.#...#...#.#...#...#...#.#...#.#.#...#.#...#...#.......#.....#.....#...#.#.............#.......#...#.#.#...#...#
//#.#########.###.#.###.###.#.#.#.#####.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###.###########.#.#########.###.#.#.###################.#.###.#.#.#.###.#
//#...........#...#...#.#...#.#.#.#.....#.#.#...#.#.#.#.#...#.#...#.......#...........#.....#.....###...#.............###...#.#.....#...#.#...#
//#############.#####.#.#.###.#.#.#.#####.#.#####.#.#.#.###.#.#######.#####.###############.#.#######################.###.#.#.###########.#.###
//###...#.......#####.#.#.#...#...#.....#.#.#.....#.#...###...#...###.#.....#.............#.#...#...#...#...........#.#...#...#.......#...#...#
//###.#.#.###########.#.#.#.###########.#.#.#.#####.###########.#.###.#.#####.###########.#.###.#.#.#.#.#.#########.#.#.#######.#####.#.#####.#
//#...#...#.........#.#.#.#.#...........#...#...#...###...###...#.#...#...#...#.......#...#.#...#.#.#.#.#.........#...#.#.......#...#.#.#...#.#
//#.#######.#######.#.#.#.#.#.#################.#.#####.#.###.###.#.#####.#.###.#####.#.###.#.###.#.#.#.#########.#####.#.#######.#.#.#.#.#.#.#
//#.........#.......#...#...#.............#...#.#.#...#.#.#...###.#.....#...###.....#.#.#...#.#...#.#.#...#...#...#.....#...#.....#...#...#.#.#
//###########.###########################.#.#.#.#.#.#.#.#.#.#####.#####.###########.#.#.#.###.#.###.#.###.#.#.#.###.#######.#.#############.#.#
//#.......###.#...#...#...#...............#.#.#...#.#.#.#.#.....#.#...#...#.........#...#.....#...#.#...#.#.#...###.........#...........###...#
//#.#####.###.#.#.#.#.#.#.#.###############.#.#####.#.#.#.#####.#.#.#.###.#.#####################.#.###.#.#.###########################.#######
//#.#...#.....#.#.#.#...#.#.............#...#.....#.#.#.#.....#.#...#.....#.#...........#...#...#.#.....#.#...........#...............#.......#
//#.#.#.#######.#.#.#####.#############.#.#######.#.#.#.#####.#.###########.#.#########.#.#.#.#.#.#######.###########.#.#############.#######.#
//#...#.......#.#.#.#.....#...#...#.....#.......#.#.#.......#...###...#...#.#.#.........#.#.#.#...#.....#.............#.........#...#.........#
//###########.#.#.#.#.#####.#.#.#.#.###########.#.#.###.###.#######.#.#.#.#.#.#.#########.#.#.#####.###.#######################.#.#.###########
//###...#...#...#...#.....#.#.#.#.#...###...#...#.#.###...#...#...#.#.#.#.#...#...#...###.#.#.......###.........#...###...###...#.#.###.......#
//###.#.#.#.#.###########.#.#.#.#.###.###.#.#.###.#.#####.###.#.#.#.#.#.#.#######.#.#.###.#.###################.#.#.###.#.###.###.#.###.#####.#
//#...#...#.#.....#.......#.#.#.#...#.#...#.#...#.#.#.....#...#.#...#.#.#...#...#...#.#...#.#...###...###...###.#.#.#...#.....#...#.....#...#.#
//#.#######.#####.#.#######.#.#.###.#.#.###.###.#.#.#.#####.###.#####.#.###.#.#.#####.#.###.#.#.###.#.###.#.###.#.#.#.#######.#.#########.#.#.#
//#.......#.......#.......#.#.#.#...#.#...#.....#...#.....#...#.....#.#.#...#.#.#.....#...#.#.#...#.#.#...#.#.....#...#.......#...#.......#...#
//#######.###############.#.#.#.#.###.###.###############.###.#####.#.#.#.###.#.#.#######.#.#.###.#.#.#.###.#.#.#######.#########.#.###########
//#.......#...#...#.......#.#.#.#...#.###.............#...###.#...#.#.#.#...#.#.........#.#.#...#.#.#.#.###...#.......#...#.......#...........#
//#.#######.#.#.#.#.#######.#.#.###.#.###############.#.#####.#.#.#.#.#.###.#.###.#####.#.#.###.#.#.#.#.#############.###.#.#################.#
//#.......#.#...#.#...#...#.#.#.#...#.#...........#...#.....#...#.#.#.#.###.#.#...#...#...#...#.#.#.#.#.#.............#...#.#.................#
//#######.#.#####.###.#.#.#.#.#.#.###.#.#########.#.#######.#####.#.#.#.###.#.#.###.#.#######.#.#.#.#.#.#.#############.###.#.#################
//#.......#.#.....###...#.#.#.#.#.......#...#...#.#.#.....#.....#.#.#.#.#...#.#...#.#.......#.#.#.#.#...#.........#...#.....#.....#...........#
//#.#######.#.###########.#.#.#.#####.###.#.#.#.#.#.#.###.#####.#.#.#.#.#.###.###.#.#######.#.#.#.#.#############.#.#.###########.#.#########.#
//#...#...#.#...........#.#.#...#...#.....#...#.#.#.#...#.......#...#...#...#.###...#.......#...#.#.#.......#.....#.#.#...........#.#.........#
//###.#.#.#.###########.#.#.#####.#.###########.#.#.###.###################.#.#######.###########.#.#.#####.#.#####.#.#.###########.#.#########
//###.#.#.#.#...........#.#.#.....#.#...###.....#...###...........###...###...#.......###...#...#...#.....#...###...#.#.............#.........#
//###.#.#.#.#.###########.#.#.#####.#.#.###.#####################.###.#.#######.#########.#.#.#.#########.#######.###.#######################.#
//#...#.#...#...#.......#...#.....#.#.#...#...#...#...............#...#...#...#...........#...#.###...###.........#...#...........#...........#
//#.###.#######.#.#####.#########.#.#.###.###.#.#.#.###############.#####.#.#.#################.###.#.#############.###.#########.#.###########
//#.....#.....#.#.#.....#...#...#.#.#.#...#...#.#.#...........#...#...#...#.#.###.......#.......#...#.#.............###.........#.#.....#...###
//#######.###.#.#.#.#####.#.#.#.#.#.#.#.###.###.#.###########.#.#.###.#.###.#.###.#####.#.#######.###.#.#######################.#.#####.#.#.###
//#...###...#.#...#.....#.#.#.#.#.#.#.#.#.......#.....#.......#.#...#.#.#...#...#.#...#...###...#...#.#.......#.......#.....#...#.....#...#...#
//#.#.#####.#.#####.###.#.#.#.#.#.#.#.#.#.#.#########.#.#######.###.#.#.#.#####.#.#.#.#######.#.###.#.#######.#.#####.#.###.#.#######.#######.#
//#.#.......#.......###.#.#.#.#.#.#...#...#.#.........#.......#.#...#.#.#.....#.#...#.#.....#.#.#...#.#...#...#...#...#...#.#...#...#.#.......#
//#.###################.#.#.#.#.#.#########.#.###############.#.#.###.#.#####.#.#####.#.###.#.#.#.###.#.#.#.#####.#.#####.#.###.#.#.#.#.#######
//#.#...............###...#.#.#.#.#.........#.........#...#...#.#...#.#...#...#.#.......#...#.#.#...#.#.#.#...###.#.#...#.#.#...#.#.#...#...###
//#.#.#############.#######.#.#.#.#.#################.#.#.#.###.###.#.###.#.###.#.###.###.###.#.###.#.#.#.###.###.#.#.#.#.#.#.#.#.#.#####.#.###
//#.#.#.............#...###...#...#.......#.......#...#.#.#...#.###...###.#...#...#...###...#.#.###.#.#.#.#...#...#.#.#.#.#...#...#...###.#.###
//#.#.#.#############.#.#################.#.#####.#.###.#.###.#.#########.###.#####.#######.#.#.###.#.#.#.#.###.###.#.#.#.###########.###.#.###
//#.#.#...#...#...#...#...#...#...#...#...#.....#.#.#...#.#...#.........#.#...#...#.....#...#.#.#...#.#.#.......###.#.#.#.#.........#.....#...#
//#.#.###.#.#.#.#.#.#####.#.#.#.#.#.#.#.#######.#.#.#.###.#.###########.#.#.###.#.#####.#.###.#.#.###.#.###.#######.#.#.#.#.#######.#########.#
//#.#.###...#...#...#.....#.#...#.#.#.#.#.......#...#...#.#...#...#...#.#.#.#...#.......#...#.#.#...#.#.###...#...#...#.#.#.......#...#...#...#
//#.#.###############.#####.#####.#.#.#.#.#############.#.###.#.#.#.#.#.#.#.#.#############.#.#.###.#.#.#####.#.#.#####.#.#######.###.#.#.#.###
//#.#.#.............#.....#.....#...#.#.#...#...#...#...#.......#...#...#...#.............#.#.#...#.#...#.....#.#.#...#...###...#...#.#.#.#...#
//#.#.#.###########.#####.#####.#####.#.###.#.#.#.#.#.#######.###########################.#.#.###.#.#####.#####.#.#.#.#######.#.###.#.#.#.###.#
//#.#.#...........#.#.....#####.....#...###.#.#.#.#.#.#.......#.......#...#.............#.#.#...#...###...#.....#.#.#.....#...#.....#...#.....#
//#.#.###########.#.#.#############.#######.#.#.#.#.#.#.#######.#####.#.#.#.###########.#.#.###.#######.###.#####.#.#####.#.###################
//#.#.#...........#...#...#.......#.......#.#.#.#.#...#.......#.#.....#.#.#...........#...#...#...#...#...#.#.....#.#.....#...#.....#.........#
//#.#.#.###############.#.#.#####.#######.#.#.#.#.###########.#.#.#####.#.###########.#######.###.#.#.###.#.#.#####.#.#######.#.###.#.#######.#
//#.#.#...............#.#.#.....#.........#.#.#.#.#.........#...#...#...#.#...###.....#.....#.....#.#...#...#.......#.#...#...#.#...#.#.......#
//#.#.###############.#.#.#####.###########.#.#.#.#.#######.#######.#.###.#.#.###.#####.###.#######.###.#############.#.#.#.###.#.###.#.#######
//#...###...........#...#...###...........#.#.#...#.......#.#.......#...#.#.#...#.....#.#...#.....#.#...#...#.......#...#.#.....#.....#.......#
//#######.#########.#######.#############.#.#.###########.#.#.#########.#.#.###.#####.#.#.###.###.#.#.###.#.#.#####.#####.###################.#
//#...#...#.......#.........#.......#.....#...###...#.....#...#...#...#.#.#.#...#.....#.#...#.#...#.#...#.#.#.....#.#...#.#.......#.....#.....#
//#.#.#.###.#####.###########.#####.#.###########.#.#.#########.#.#.#.#.#.#.#.###.#####.###.#.#.###.###.#.#.#####.#.#.#.#.#.#####.#.###.#.#####
//#.#...#...#...#...#...#...#...###...#...........#.#.....###...#.#.#...#.#.#.........#.#...#.#...#.#...#.#.#...#.#...#...#.....#.#...#.#.....#
//#.#####.###.#.#.#.#.#.#.#.###.#######.###########.#####.###.###.#.#####.#.#####.###.#.#.###.###.#.#.###.#.#.#.#.#############.#.###.#.#####.#
//#.....#.#...#...#...#.#.#.......#...#.....#.......#...#...#...#.#.#.....#...#...###...#.#...#...#.#.#...#.#.#.#...#...#.......#.#...#.#.....#
//#####.#.#.###########.#.#####.#.#.#.#####.#.#######.#.###.###.#.#.#.#######.#.#########.#.###.###.#.#.###.#.#.###.#.#.#.#######.#.###.#.#####
//#####...#...........#...###...#...#.#.....#.....#...#.....#...#.#.#...#.....#.......###.#.#...###.#.#...#.#.#.#...#.#.#.....###...###.#.....#
//###################.#######.#######.#.#########.#.#########.###.#.###.#.###########.###.#.#.#####.#.###.#.#.#.#.###.#.#####.#########.#####.#
//#...................#.....#...#.....#.....#.....#.......#...###.#.###...#...#...#...#...#.#.#.....#...#.#.#.#.....#.#.......#.....###.#.....#
//#.###################.###.###.#.#########.#.###########.#.#####.#.#######.#.#.#.#.###.###.#.#.#######.#.#.#.###.#.#.#######.#.###.###.#.#####
//#...#...............#...#.....#...#.....#.#...#...#.......#...#.#.#.......#...#...###...#.#.#.......#...#...#...#.#.#.......#...#...#.#.....#
//###.#.#############.###.#########.#.###.#.###.#.#.#.###.###.#.#.#.#.###################.#.#.#######.#########.###.#.#.#########.###.#.#####.#
//###...#.............###...#.....#...###...###...#.#.#...###.#.#...#.#.....#...#...#...#...#.........###...#...###...#...........#...#.....#.#
//#######.#################.#.###.#################.#.#.#####.#.#####.#.###.#.#.#.#.#.#.#################.#.#.#####################.#######.#.#
//#.....#.............#.....#.###...#...###...#.....#.#.......#.....#...###...#...#...#.....###...###.....#...#.........#...#.......#...###...#
//#.###.#############.#.#####.#####.#.#.###.#.#.#####.#############.#######################.###.#.###.#########.#######.#.#.#.#######.#.#######
//#...#...............#.#.....#...#...#...#.#...#.....#.............#...............#.....#.....#...#.....#...#.#.......#.#.#.......#.#.......#
//###.#################.#.#####.#.#######.#.#####.#####.#############.#############.#.###.#########.#####.#.#.#.#.#######.#.#######.#.#######.#
//###...#...#.....#...#...#.....#.......#.#...#...#.....#...#...#...#...........###...###.#.........#...#.#.#...#...#.....#.........#.#.......#
//#####.#.#.#.###.#.#.#####.###########.#.###.#.###.#####.#.#.#.#.#.###########.#########.#.#########.#.#.#.#######.#.###############.#.#######
//#####...#...###...#.....#.......#...#...###...###...#...#...#.#.#.#...#...###...#...###...#.....###.#.#...#.....#.#.#...#.....#...#.#.#...###
//#######################.#######.#.#.###############.#.#######.#.#.#.#.#.#.#####.#.#.#######.###.###.#.#####.###.#.#.#.#.#.###.#.#.#.#.#.#.###
//#.......................###...#...#.........#...#...#.#.......#.#.#.#.#.#.###...#.#...#...#.#...#...#.......###...#...#...#...#.#...#...#...#
//#.#########################.#.#############.#.#.#.###.#.#######.#.#.#.#.#.###.###.###.#.#.#.#.###.#########################.###.###########.#
//#.................#.....#...#.#.............#.#.#.....#...###...#.#.#.#.#.#.....#.#...#.#...#...#...#.......#...#...#...#...#...#...........#
//#################.#.###.#.###.#.#############.#.#########.###.###.#.#.#.#.#.###.#.#.###.#######.###.#.#####.#.#.#.#.#.#.#.###.###.###########
//#...#...#...###...#.#...#...#.#.....#.......#.#.#...........#...#...#.#.#...#...#.#...#.....#...#...#.#.....#.#.#.#.#.#.#...#.#...#...#.....#
//#.#.#.#.#.#.###.###.#.#####.#.#####.#.#####.#.#.#.#########.###.#####.#.#####.###.###.#####.#.###.###.#.#####.#.#.#.#.#.###.#.#.###.#.#.###.#
//#.#...#...#.....###.#...#...#.#...#.#.#.....#.#.#.......#...#...#.....#.....#...#.#...#...#.#...#.....#.....#.#.#.#.#.#.#...#.#...#.#.#.#...#
//#.#################.###.#.###.#.#.#.#.#.#####.#.#######.#.###.###.#########.###.#.#.###.#.#.###.###########.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###
//#.........#.....#...#...#...#...#.#...#...#...#.#...#...#.....###...#.....#...#.#.#.#...#.#.#...#...#.......#.#...#...#...#.#.#...#.#.#.#...#
//#########.#.###.#.###.#####.#####.#######.#.###.#.#.#.#############.#.###.###.#.#.#.#.###.#.#.###.#.#.#######.#############.#.#.###.#.#.###.#
//#...#...#.#...#.#.#...#...#...#...#...###.#...#.#.#.#.........#...#.#...#.#...#...#.#.#...#.#...#.#.#.......#.............#...#.....#.#.#...#
//#.#.#.#.#.###.#.#.#.###.#.###.#.###.#.###.###.#.#.#.#########.#.#.#.###.#.#.#######.#.#.###.###.#.#.#######.#############.###########.#.#.###
//#.#...#...#...#...#...#.#...#.#...#.#.#.....#.#.#.#.#.....#...#.#.#.#...#.#...#.....#.#...#.#...#.#.#...#.....#...#...#...#...........#.#...#
//#.#########.#########.#.###.#.###.#.#.#.###.#.#.#.#.#.###.#.###.#.#.#.###.###.#.#####.###.#.#.###.#.#.#.#.###.#.#.#.#.#.###.###########.###.#
//#...#.......###.......#...#...###.#.#...###.#.#.#.#.#...#.#...#.#...#.#...#...#...#...#...#.#...#.#...#.#.###...#.#.#.#.#...#.....#...#.#...#
//###.#.#########.#########.#######.#.#######.#.#.#.#.###.#.###.#.#####.#.###.#####.#.###.###.###.#.#####.#.#######.#.#.#.#.###.###.#.#.#.#.###
//#...#.#.........#...#...#.#.......#.......#.#.#.#.#.#...#.#...#...#...#...#.....#.#.###...#.###.#.#.....#...#.....#.#.#.#...#.#...#.#.#.#.###
//#.###.#.#########.#.#.#.#.#.#############.#.#.#.#.#.#.###.#.#####.#.#####.#####.#.#.#####.#.###.#.#.#######.#.#####.#.#.###.#.#.###.#.#.#.###
//#.....#...........#...#...#...............#...#...#...###...#####...#####.......#...#####...###...#.........#.......#...###...#.....#...#...#
//###########################################################################################################################################.#";

//var smallInput =
//@"#S#####################
//#.......#########...###
//#######.#########.#.###
//###.....#.>.>.###.#.###
//###v#####.#v#.###.#.###
//###.>...#.#.#.....#...#
//###v###.#.#.#########.#
//###...#.#.#.......#...#
//#####.#.#.#######.#.###
//#.....#.#.#.......#...#
//#.#####.#.#.#########v#
//#.#...#...#...###...>.#
//#.#.#v#######v###.###v#
//#...#.>.#...>.>.#.###.#
//#####v#.#.###v#.#.###.#
//#.....#...#...#.#.#...#
//#.#########.###.#.#.###
//#...###...#...#...#.###
//###.###.#.###v#####v###
//#...#...#.#.>.>.#.>.###
//#.###.###.#.###.#.#v###
//#.....###...###...#...#
//#####################E#";



//var input = smallInput;
//input = fullInput;
////input = smallest;
//var timer = System.Diagnostics.Stopwatch.StartNew();

//var result = long.MaxValue;

//var grid = Utils.ParseCoordGrid(input, (x) => x.c == '#' ? null : new Cell { y = x.y, x = x.x }).Where(x => x != null).ToList();
//Utils.SetNeighbours(grid, x => x.Neighbours, x => x.x, x => x.y);

//var start = grid.First();
//var target = grid.Last();

//var junctions = grid.Where(x => x.Neighbours.Count > 2).ToList();
//junctions.Insert(0, start);
//junctions.Add(target);

//var distances = new Dictionary<(Cell, Cell), long>();

//foreach (var junction in junctions)
//{
//    CalculateDistances(junction, new HashSet<Cell> { junction });
//}

//void CalculateDistances(Cell position, HashSet<Cell> pathTaken)
//{
//    if (junctions.Contains(position) && pathTaken.Count > 1)
//    {
//        distances[(pathTaken.First(), pathTaken.Last())] = pathTaken.Count - 1;
//        return;
//    }
//    foreach (var item in position.Neighbours.Except(pathTaken))
//    {
//        var cpy = pathTaken.ToHashSet();
//        cpy.Add(item);
//        CalculateDistances(item, cpy);
//    }
//}

//var flatDistances = distances.Select(x => (x.Key.Item1, x.Key.Item2, x.Value)).ToList();

//var pq = new PriorityQueue<(Cell position, HashSet<Cell> pathTaken, long score), long>();
//pq.Enqueue((start, new HashSet<Cell>(), 0), 0);

//int i = 0;


//var results = new HashSet<long>();
//var paths = new List<HashSet<Cell>>();

//var deadends = new HashSet<(short x, short y)>();
//while (pq.Count > 0)
//{
//    var (position, pathTaken, score) = pq.Dequeue();
//    //if (i % 100 == 0)
//    {
//        Console.WriteLine($"{i}i {pq.Count}queue {score}score {deadends.Count}dead");
//    }
//    i++;

//    if (position == target)
//    {
//        results.Add(score);
//        result = Math.Min(result, score);
//        paths.Add(pathTaken);
//        if (score == result)
//        {
//            //bestPath = pathTaken;
//        }
//    }

//    var unvisitedNeighbours = flatDistances.Where(x => x.Item1 == position && !pathTaken.Contains(x.Item2)).ToList();

//    foreach (var direction in unvisitedNeighbours)
//    {
//        var cost = direction.Value;
//        var newTotal = score + cost;
//        var newPathTaken = pathTaken.ToHashSet();
//        newPathTaken.Add(direction.Item2);
//        pq.Enqueue((direction.Item2, newPathTaken, newTotal), newTotal);
//    }
//}

//foreach (var item in results)
//{
//    Console.WriteLine(item);
//}

//result = results.Last();

//timer.Stop();
//Console.WriteLine(result);
//Console.WriteLine(timer.ElapsedMilliseconds + "ms");
//Console.ReadLine();

//class Cell
//{
//    public int x;
//    public int y;
//    public HashSet<Cell> Neighbours = new HashSet<Cell>();
//    public override string ToString() => $"{x},{y}";
//}